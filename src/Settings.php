<?php
namespace UmutPHP\WPVulnerabilityCheck;

class Settings
{
    /**
     * Full path of the plugin directory to check
     * @var string
     */
    public $path = '.';

    /**
     * Dont't check files or directories
     * @var array
     */
    public $excluded = array();

    /**
     * Use colors in console output
     * @var bool
     */
    public $colors = true;

    /**
     * The API Token taken from the wpvulndb.com site to use API.
     * @var bool
     */
    public $token = '';
    /**
     * @param array $arguments
     * @return Settings
     * @throws Exception\InvalidArgument
     */
    public static function parseArguments(array $arguments)
    {
        $arguments       = new ArrayIterator(array_slice($arguments, 1));
        $setting         = new self;

        foreach ($arguments as $argument) {
            if ($argument{0} !== '-') {
                $setting->paths[] = $argument;
            } else {
                switch ($argument) {
                    case '--path':
                        $setting->path = trim($arguments->getNext());
                        break;
                    case '--token':
                        $setting->token = trim($arguments->getNext());
                        break;
                    case '--exclude':
                        $setting->excluded[] = explode(',', $arguments->getNext());
                        break;
                    case '--no-colors':
                        $setting->colors = false;
                        break;
                    default:
                        throw new \Exception("Invalid argument $argument");
                }
            }
        }

        return $setting;
    }
}
