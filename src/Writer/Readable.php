<?php
namespace UmutPHP\WPVulnerabilityCheck\Writer;

class Readable extends Writer
{
    /**
     * Echo line with end of line
     * 
     * @param string $output
     */
    public function writeLine($output = "") {
        $this->write($output);
        echo PHP_EOL;
    }

    /**
     * Echo line
     * 
     * @param string $output
     */
    public function write($output = "") {
        echo $output;
    }

    /**
     * Echo result line
     * 
     * @param string $plugin
     * @param string $result
     */
    public function writeResult($plugin, $result) {
        $this->writeLine($plugin);
        $j = 1;
        foreach ($result as $key => $vuln) {
            $this->writeLine(
                "\t" . $j . ") id: " . $vuln["id"] . ", " .  $vuln["title"]
            );
            $this->writeLine(
                "\t" . "Fixed in Version " . $vuln["fixed_in"]
            );
            $this->writeLine(
                "\tReferences: " . implode(", ", $vuln["references"]["url"])
            );
            $j++;
            $this->writeLine();
        }
    }
}
