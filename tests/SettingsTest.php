<?php
use UmutPHP\WPVulnerabilityCheck;
use PHPUnit\Framework\TestCase;

class SettingsTest extends TestCase
{
    private $settings;

    public function __construct()
    {
        parent::__construct();
        $this->settings = new WPVulnerabilityCheck\Settings();
    }
    
    public function testParserArgumentsInvalidArgument()
    {
        $arguments = array('wp-vulnerability-check', '--invalid');
        $this->expectException(\Exception::class);
        WPVulnerabilityCheck\Settings::parseArguments($arguments);
    }

    public function testParserArgumentsWithNoDash()
    {
        $arguments = array('wp-vulnerability-check', 'withnodash');
        $this->expectException(\Exception::class);
        WPVulnerabilityCheck\Settings::parseArguments($arguments);
    }

    public function testParserArguments()
    {
        $arguments = array(
            'wp-vulnerability-check',
            '--path', 'path',
            '--token', 'token',
            '--exclude', 'exclude',
            '--output', 'output'
        );
        $settings = WPVulnerabilityCheck\Settings::parseArguments($arguments);

        $this->assertEquals($settings->path, 'path');
        $this->assertEquals($settings->token, 'token');
        $this->assertEquals($settings->excluded, array('exclude'));
        $this->assertEquals($settings->output, 'output');
    }
}
