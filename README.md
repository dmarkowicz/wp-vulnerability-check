# WordPress Vulnerability Check (wp-vulnerability-check)
[![Build Status](https://travis-ci.org/umutphp/wp-vulnerability-check.svg?branch=master)](https://travis-ci.org/umutphp/wp-vulnerability-check) [![Latest Stable Version](https://poser.pugx.org/umutphp/wp-vulnerability-check/v/stable)](https://packagist.org/packages/umutphp/wp-vulnerability-check) [![Total Downloads](https://poser.pugx.org/umutphp/wp-vulnerability-check/downloads)](https://packagist.org/packages/umutphp/wp-vulnerability-check) [![Latest Unstable Version](https://poser.pugx.org/umutphp/wp-vulnerability-check/v/unstable)](https://packagist.org/packages/umutphp/wp-vulnerability-check) [![composer.lock](https://poser.pugx.org/umutphp/wp-vulnerability-check/composerlock)](https://packagist.org/packages/umutphp/wp-vulnerability-check) [![CircleCI](https://circleci.com/gh/umutphp/wp-vulnerability-check.svg?style=svg)](https://circleci.com/gh/umutphp/wp-vulnerability-check)

A command line took to check the WPScan Vulnerability Database via API to identify the security issues of WordPress plugins installed.

# Installation
It can be installed as a stand-alone tool or used as a test on your CI pipeline.

```
composer require umutphp/wp-vulnerability-check --dev

```

# CLI Usage
After succesfull installation, you can display the options as follows;

```

$ ./vendor/bin/wp-vulnerability-check --help
---------------------------
WP Vulnerability Check version 0.0.1
---------------------------
Usage: wp-vulnerability-check [options]
Options:
    --path      Full path for the plugin directory of your WordPress installation.
    --token     Token got from wpvulndb.com
    --exclude   Exclude the plugins given in comma separated format.
    --output    The format of output. Valid values JSON, READABLE, NO (Default).
    --version   Show version.
    --help      Print this help.

```

A sample excution with vulnerability details,

```
$ ./wp-vulnerability-check --path /path/to/plugins/ --token token --output readable

Checking plugins...

.V...

Checked 5 plugins in 1.5 second, found some vulnerability(s) in 1 plugin.

The plugin which is not in WPScan Vulnerability Database; hello.
PS: You can exclude your custom plugins with --exclude parameter.

------------------------------------------------------------
Vulnerability Details

custom-css-js
        1) id: 8879, Simple Custom CSS and JS <= 3.3 - Authenticated Cross-Site Scripting (XSS)
        Fixed in Version 3.4
        References: https://jvn.jp/en/jp/JVN31459091/index.html, https://plugins.trac.wordpress.org/changeset/1695440/#file6

```

A sample execution without vulnerability details;

```
$ ./wp-vulnerability-check --path /path/to/plugins/ --token token 

Checking plugins...

.V...

Checked 5 plugins in 1.5 second, found some vulnerability(s) in 1 plugin.

The plugin which is not in WPScan Vulnerability Database; hello.
PS: You can exclude your custom plugins with --exclude parameter.
```
